<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Chat - リアルタイムチャット</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#667eea">
    <meta name="description" content="Modern realtime chat application with Socket.IO">
</head>
<body>
    <div class="app-container">
        <!-- ヘッダー -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">💬</div>
                    <h1>Modern Chat</h1>
                </div>
                <div class="header-actions">
                    <button class="theme-toggle" id="themeToggle" aria-label="テーマ切替">
                        <span class="theme-icon">🌙</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- メインコンテンツ -->
        <main class="main-content">
            <!-- 接続フォーム -->
            <div class="connection-panel" id="connectionPanel">
                <div class="connection-card">
                    <div class="card-header">
                        <h2>チャットルームに参加</h2>
                        <p>名前とルーム名を入力してチャットを開始しましょう</p>
                    </div>
                    <div class="form-group">
                        <label for="nameInput">ユーザー名</label>
                        <input type="text" id="nameInput" placeholder="あなたの名前を入力" autocomplete="off" maxlength="32">
                    </div>
                    <div class="form-group">
                        <label for="roomInput">ルーム名</label>
                        <div class="input-with-toggle">
                            <input type="text" id="roomInput" placeholder="参加するルーム名" autocomplete="off" maxlength="64">
                            <button class="visibility-toggle" id="visibilityToggle" type="button" aria-label="ルーム名表示切替">
                                <span class="visibility-icon">👁️</span>
                            </button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="privateCheckbox">
                            <span class="checkmark"></span>
                            プライベートルーム
                        </label>
                    </div>
                    <div class="form-group" id="passwordGroup" style="display: none;">
                        <label for="passwordInput">パスワード</label>
                        <input type="password" id="passwordInput" placeholder="ルームのパスワードを入力" autocomplete="off" minlength="4">
                    </div>
                    <button class="join-button" id="joinButton" type="button">
                        <span class="button-text">参加する</span>
                        <span class="button-icon">→</span>
                    </button>
                </div>
                
                <!-- オンラインリスト -->
                <div class="online-lists">
                    <div class="online-section">
                        <h3>🟢 オンラインユーザー</h3>
                        <div class="online-list" id="onlineUsers">
                            <div class="empty-online">オンラインユーザーがいません</div>
                        </div>
                    </div>
                    <div class="online-section">
                        <h3>🏠 アクティブルーム</h3>
                        <div class="online-list" id="onlineRooms">
                            <div class="empty-online">アクティブなルームがありません</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- チャットエリア -->
            <div class="chat-area" id="chatArea" style="display: none;">
                <div class="chat-header">
                    <div class="room-info">
                        <div class="room-indicator"></div>
                        <div class="room-details">
                            <h3 id="currentRoom">ルーム名</h3>
                            <p id="currentUser">ユーザー名</p>
                        </div>
                    </div>
                    <div class="header-stats">
                        <div class="stat">
                            <span class="stat-label">ユーザー:</span>
                            <span id="userCount">1</span>
                        </div>
                        <button class="leave-button" id="leaveButton" type="button">退出</button>
                    </div>
                </div>

                <div class="chat-container">
                    <div class="message-section">
                        <div class="section-header">
                            <h4>メッセージ 1</h4>
                            <div class="status-dot"></div>
                        </div>
                        <div class="message-display" id="messageDisplay1">
                            <div class="empty-state">
                                <div class="empty-icon">💭</div>
                                <p>メッセージがここに表示されます</p>
                            </div>
                        </div>
                        <div class="input-container">
                            <input type="text" id="inputText1" placeholder="メッセージを入力..." autocomplete="off" maxlength="1000">
                        </div>
                    </div>

                    <div class="message-section">
                        <div class="section-header">
                            <h4>メッセージ 2</h4>
                            <div class="status-dot"></div>
                        </div>
                        <div class="message-display" id="messageDisplay2">
                            <div class="empty-state">
                                <div class="empty-icon">💭</div>
                                <p>メッセージがここに表示されます</p>
                            </div>
                        </div>
                        <div class="input-container">
                            <input type="text" id="inputText2" placeholder="メッセージを入力..." autocomplete="off" maxlength="1000">
                        </div>
                    </div>
                    
                    <!-- サイドバー（オンライン情報） -->
                    <div class="sidebar">
                        <div class="sidebar-section">
                            <h4>🟢 ルーム内ユーザー</h4>
                            <div class="user-list" id="roomUsers">
                                <div class="empty-sidebar">読み込み中...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Socket.IOとスクリプトの読み込み -->
    <script>
        // Socket.IOの読み込みを確認
        window.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded');
            
            // Socket.IOの存在確認
            if (typeof io === 'undefined') {
                console.error('Socket.IO not loaded');
                alert('アプリケーションの読み込みに失敗しました。ページを再読み込みしてください。');
                return;
            }
            
            console.log('Socket.IO loaded successfully');
        });
    </script>
    <script src="https://cdn.socket.io/4.7.4/socket.io.min.js" onerror="console.error('Failed to load Socket.IO from CDN')"></script>
    <script src="script.js" onerror="console.error('Failed to load main script')"></script>
</body>
</html>