# Modern Realtime Chat

モダンでスタイリッシュなリアルタイムチャットアプリケーション

## 🌟 機能

### ✅ 実装済み機能
- **リアルタイムチャット**: 2つの独立したメッセージチャンネル
- **オンラインユーザー一覧**: 接続中のユーザーをリアルタイム表示
- **アクティブルーム一覧**: 人が在室している公開ルームを表示
- **プライベートルーム**: パスワード保護されたプライベートルーム
- **即座のオフライン検知**: ページを閉じると即座にオフライン扱い
- **空ルーム自動削除**: 最後の人が抜けるとルームが自動削除
- **ダークモード**: ライト/ダークテーマ切替
- **レスポンシブデザイン**: モバイル対応
- **PWA対応**: オフラインキャッシュとインストール可能

### 🔒 プライベートルーム機能
- プライベートルームは公開リストに表示されない
- 4文字以上のパスワード設定が必須
- パスワードはハッシュ化して安全に保存
- 入室時にパスワード認証が必要

### 🟢 オンライン機能
- **オンラインユーザー**: 現在接続中のユーザーのみ表示
- **アクティブルーム**: 人がいる公開ルームのみ表示（人数付き）
- **ルーム内ユーザー**: 同じルーム内のメンバー一覧
- **リアルタイム更新**: 参加/退出時に即座に更新

## 🚀 Renderでのデプロイ

### 1. リポジトリの準備
```bash
# リポジトリをクローン
git clone https://github.com/SOUTAPLAY/modern-realtime-chat.git
cd modern-realtime-chat

# 依存関係をインストール（開発時）
npm install

# ローカル実行
npm start
```

### 2. Renderでの設定
1. [Render](https://render.com) にアクセス
2. 新しい「Web Service」を作成
3. GitHubリポジトリを接続
4. 以下の設定を入力：
   - **Build Command**: `npm install`
   - **Start Command**: `npm start`
   - **Environment**: `Node`

### 3. 環境変数（オプション）
- `NODE_ENV`: `production`（本番環境用）
- `PORT`: 自動設定（Renderが自動で設定）

### 4. デプロイ確認
デプロイ後、以下を確認してください：
- ✅ アプリにアクセスできる
- ✅ 複数のタブ/デバイスで同時接続可能
- ✅ オンラインユーザー一覧が更新される
- ✅ プライベートルームが作成・参加できる
- ✅ タブを閉じると即座にオフライン表示
- ✅ 空になったルームが自動削除される

## 📱 使い方

### 基本的な使用方法
1. **ユーザー名**と**ルーム名**を入力
2. **プライベートルーム**にしたい場合はチェックを入れてパスワードを設定
3. 「参加する」ボタンでルームに入室
4. 2つのメッセージチャンネルでリアルタイムチャット
5. 右側のサイドバーでルーム内メンバーを確認

### プライベートルーム
1. 「プライベートルーム」にチェック
2. 4文字以上のパスワードを入力
3. ルーム作成後、他の人は同じルーム名とパスワードで参加可能
4. プライベートルームは公開リストに表示されません

### オンライン機能
- **左側パネル**: 全体のオンラインユーザーとアクティブルーム
- **右側サイドバー**: 現在のルーム内メンバー
- **リアルタイム更新**: 参加・退出時に即座に反映

## 🛠 技術仕様

### フロントエンド
- **HTML5**: セマンティックマークアップ
- **CSS3**: CSS変数、グリッドレイアウト、アニメーション
- **JavaScript**: ES6+、Socket.IOクライアント
- **PWA**: Service Worker、Web App Manifest

### バックエンド
- **Node.js**: ES Modules使用
- **Express.js**: 静的ファイル配信
- **Socket.IO**: リアルタイム通信
- **crypto**: パスワードハッシュ化

### セキュリティ
- パスワードのハッシュ化（scrypt + salt）
- XSS対策（入力サニタイズ）
- 入力値検証とサイズ制限
- レート制限（Socket.IOの設定）

## 📂 ファイル構成

```
modern-realtime-chat/
├── package.json          # Node.js設定
├── server.js             # Express + Socket.IOサーバー
├── index.html            # メインHTML
├── style.css             # スタイルシート
├── script.js             # フロントエンドJS
├── manifest.json         # PWA設定
├── sw.js                 # Service Worker
└── README.md             # このファイル
```

## 🔧 開発

### ローカル開発
```bash
# 開発モード実行
npm run dev

# 本番モード実行
npm start
```

### カスタマイズ
- **テーマカラー**: `style.css`の`:root`変数を変更
- **メッセージ制限**: `server.js`の文字数制限を調整
- **ルーム機能**: `server.js`で追加機能を実装

## 📞 サポート

問題や提案がある場合は、GitHubのIssuesでお知らせください。

---

**Modern Realtime Chat** - リアルタイムコミュニケーションを美しく、簡単に。